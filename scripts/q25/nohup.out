41
47
48
59
60
61
64
65
66
74
75
47
53
54
65
66
67
70
71
72
80
81
48
54
55
66
67
68
71
72
73
81
82
78
84
85
96
97
98
101
102
103
111
112
68
74
75
86
87
88
91
92
93
101
102
59
65
66
77
78
79
82
83
84
92
93
69
75
76
87
88
89
92
93
94
102
103
60
66
67
78
79
80
83
84
85
93
94
70
76
77
88
89
90
93
94
95
103
104
61
67
68
79
80
81
84
85
86
94
95
90
96
97
108
109
110
113
114
115
123
124
91
97
98
109
110
111
114
115
116
124
125
47
53
54
65
66
67
70
71
72
80
81
53
59
60
71
72
73
76
77
78
86
87
54
60
61
72
73
74
77
78
79
87
88
84
90
91
102
103
104
107
108
109
117
118
74
80
81
92
93
94
97
98
99
107
108
65
71
72
83
84
85
88
89
90
98
99
75
81
82
93
94
95
98
99
100
108
109
66
72
73
84
85
86
89
90
91
99
100
76
82
83
94
95
96
99
100
101
109
110
67
73
74
85
86
87
90
91
92
100
101
96
102
103
114
115
116
119
120
121
129
130
97
103
104
115
116
117
120
121
122
130
131
48
54
55
66
67
68
71
72
73
81
82
54
60
61
72
73
74
77
78
79
87
88
55
61
62
73
74
75
78
79
80
88
89
85
91
92
103
104
105
108
109
110
118
119
75
81
82
93
94
95
98
99
100
108
109
66
72
73
84
85
86
89
90
91
99
100
76
82
83
94
95
96
99
100
101
109
110
67
73
74
85
86
87
90
91
92
100
101
77
83
84
95
96
97
100
101
102
110
111
68
74
75
86
87
88
91
92
93
101
102
97
103
104
115
116
117
120
121
122
130
131
98
104
105
116
117
118
121
122
123
131
132
64
70
71
82
83
84
87
88
89
97
98
70
76
77
88
89
90
93
94
95
103
104
71
77
78
89
90
91
94
95
96
104
105
101
107
108
119
120
121
124
125
126
134
135
91
97
98
109
110
111
114
115
116
124
125
82
88
89
100
101
102
105
106
107
115
116
92
98
99
110
111
112
115
116
117
125
126
83
89
90
101
102
103
106
107
108
116
117
93
99
100
111
112
113
116
117
118
126
127
84
90
91
102
103
104
107
108
109
117
118
113
119
120
131
132
133
136
137
138
146
147
114
120
121
132
133
134
137
138
139
147
148
65
71
72
83
84
85
88
89
90
98
99
71
77
78
89
90
91
94
95
96
104
105
72
78
79
90
91
92
95
96
97
105
106
102
108
109
120
121
122
125
126
127
135
136
92
98
99
110
111
112
115
116
117
125
126
83
89
90
101
102
103
106
107
108
116
117
93
99
100
111
112
113
116
117
118
126
127
84
90
91
102
103
104
107
108
109
117
118
94
100
101
112
113
114
117
118
119
127
128
85
91
92
103
104
105
108
109
110
118
119
114
120
121
132
133
134
137
138
139
147
148
115
121
122
133
134
135
138
139
140
148
149
66
72
73
84
85
86
89
90
91
99
100
72
78
79
90
91
92
95
96
97
105
106
73
79
80
91
92
93
96
97
98
106
107
103
109
110
121
122
123
126
127
128
136
137
93
99
100
111
112
113
116
117
118
126
127
84
90
91
102
103
104
107
108
109
117
118
94
100
101
112
113
114
117
118
119
127
128
85
91
92
103
104
105
108
109
110
118
119
95
101
102
113
114
115
118
119
120
128
129
86
92
93
104
105
106
109
110
111
119
120
115
121
122
133
134
135
138
139
140
148
149
116
122
123
134
135
136
139
140
141
149
150
71
77
78
89
90
91
94
95
96
104
105
77
83
84
95
96
97
100
101
102
110
111
78
84
85
96
97
98
101
102
103
111
112
108
114
115
126
127
128
131
132
133
141
142
98
104
105
116
117
118
121
122
123
131
132
89
95
96
107
108
109
112
113
114
122
123
99
105
106
117
118
119
122
123
124
132
133
90
96
97
108
109
110
113
114
115
123
124
100
106
107
118
119
120
123
124
125
133
134
91
97
98
109
110
111
114
115
116
124
125
120
126
127
138
139
140
143
144
145
153
154
121
127
128
139
140
141
144
145
146
154
155
72
78
79
90
91
92
95
96
97
105
106
78
84
85
96
97
98
101
102
103
111
112
79
85
86
97
98
99
102
103
104
112
113
109
115
116
127
128
129
132
133
134
142
143
99
105
106
117
118
119
122
123
124
132
133
90
96
97
108
109
110
113
114
115
123
124
100
106
107
118
119
120
123
124
125
133
134
91
97
98
109
110
111
114
115
116
124
125
101
107
108
119
120
121
124
125
126
134
135
92
98
99
110
111
112
115
116
117
125
126
121
127
128
139
140
141
144
145
146
154
155
122
128
129
140
141
142
145
146
147
155
156
73
79
80
91
92
93
96
97
98
106
107
79
85
86
97
98
99
102
103
104
112
113
80
86
87
98
99
100
103
104
105
113
114
110
116
117
128
129
130
133
134
135
143
144
100
106
107
118
119
120
123
124
125
133
134
91
97
98
109
110
111
114
115
116
124
125
101
107
108
119
120
121
124
125
126
134
135
92
98
99
110
111
112
115
116
117
125
126
102
108
109
120
121
122
125
126
127
135
136
93
99
100
111
112
113
116
117
118
126
127
122
128
129
140
141
142
145
146
147
155
156
123
129
130
141
142
143
146
147
148
156
157
90
96
97
108
109
110
113
114
115
123
124
96
102
103
114
115
116
119
120
121
129
130
97
103
104
115
116
117
120
121
122
130
131
127
133
134
145
146
147
150
151
152
160
161
117
123
124
135
136
137
140
141
142
150
151
108
114
115
126
127
128
131
132
133
141
142
118
124
125
136
137
138
141
142
143
151
152
109
115
116
127
128
129
132
133
134
142
143
119
125
126
137
138
139
142
143
144
152
153
110
116
117
128
129
130
133
134
135
143
144
139
145
146
157
158
159
162
163
164
172
173
140
146
147
158
159
160
163
164
165
173
174
91
97
98
109
110
111
114
115
116
124
125
97
103
104
115
116
117
120
121
122
130
131
98
104
105
116
117
118
121
122
123
131
132
128
134
135
146
147
148
151
152
153
161
162
118
124
125
136
137
138
141
142
143
151
152
109
115
116
127
128
129
132
133
134
142
143
119
125
126
137
138
139
142
143
144
152
153
110
116
117
128
129
130
133
134
135
143
144
120
126
127
138
139
140
143
144
145
153
154
111
117
118
129
130
131
134
135
136
144
145
140
146
147
158
159
160
163
164
165
173
174
141
147
148
159
160
161
164
165
166
174
175
41
47
48
59
60
61
64
65
66
74
75
47
53
54
65
66
67
70
71
72
80
81
48
54
55
66
67
68
71
72
73
81
82
78
84
85
96
97
98
101
102
103
111
112
68
74
75
86
41
47
48
59
60
61
64
65
66
74
75
47
53
54
65
66
67
70
71
72
80
81
48
54
55
66
67
68
71
72
73
81
82
78
84
85
96
97
98
101
102
103
111
112
68
74
75
86
87
88
91
92
93
101
102
59
65
66
77
78
79
82
83
84
92
93
69
75
76
87
88
89
92
93
94
102
103
60
66
67
78
79
80
83
84
85
93
94
70
76
77
88
89
90
93
94
95
103
104
61
67
68
79
80
81
84
85
86
94
95
90
96
97
108
109
110
113
114
115
123
124
91
97
98
109
110
111
114
115
116
124
125
47
53
54
65
66
67
70
71
72
80
81
53
59
60
71
72
73
76
77
78
86
87
54
60
61
72
73
74
77
78
79
87
88
84
90
91
102
103
104
107
108
109
117
118
74
80
81
92
93
94
97
98
99
107
108
65
71
72
83
84
85
88
89
90
98
99
75
81
82
93
94
95
98
99
100
108
109
66
72
73
84
85
86
89
90
91
99
100
76
82
83
94
95
96
99
100
101
109
110
67
73
74
85
86
87
90
91
92
100
101
96
102
103
114
115
116
119
120
121
129
130
97
103
104
115
116
117
120
121
122
130
131
48
54
55
66
67
68
71
72
73
81
82
54
60
61
72
73
74
77
78
79
87
88
55
61
62
73
74
75
78
79
80
41
47
48
59
60
61
64
65
66
74
75
47
53
54
65
66
67
70
71
72
80
81
48
54
55
66
67
68
71
72
73
81
82
78
84
85
96
97
98
101
102
103
111
112
68
74
75
86
87
88
91
92
93
101
102
59
65
66
77
78
79
82
83
84
92
93
69
75
76
87
88
89
92
93
94
102
103
60
66
67
78
79
80
83
84
85
93
94
70
76
77
88
89
90
93
94
95
103
104
61
67
68
79
80
81
84
85
86
94
95
90
96
97
108
109
110
113
114
115
123
124
91
97
98
109
110
111
114
115
116
124
125
47
53
54
65
66
67
70
71
72
80
81
53
59
60
71
72
73
76
77
78
86
87
54
60
61
72
73
74
77
78
79
87
88
84
90
91
102
103
104
107
108
109
117
118
74
80
81
92
93
94
97
98
99
107
108
65
71
72
83
84
85
88
89
90
98
99
75
81
82
93
94
95
98
99
100
108
109
66
72
73
84
85
86
89
90
91
99
100
76
82
83
94
95
96
99
100
101
109
110
67
73
74
85
86
87
90
91
92
100
101
96
102
103
114
115
116
119
120
121
129
130
97
103
104
115
116
117
120
121
122
130
131
48
54
55
66
67
68
71
72
73
81
82
54
60
61
72
73
74
77
78
79
87
88
55
61
62
73
74
75
78
79
80
88
89
85
91
92
103
104
105
108
109
110
118
119
75
81
82
93
94
95
98
99
100
108
109
66
72
73
84
85
86
89
90
91
99
100
76
82
83
94
95
96
99
100
101
109
110
67
73
74
85
86
87
90
91
92
100
101
77
83
84
95
96
97
100
101
102
110
111
68
74
75
86
87
88
91
92
93
101
102
97
103
104
115
116
117
120
121
122
130
131
98
104
105
116
117
118
121
122
123
131
132
64
70
71
82
83
84
87
88
89
97
98
70
76
77
88
89
90
93
94
95
103
104
71
77
78
89
90
91
94
95
96
104
105
101
107
108
119
120
121
124
125
126
134
135
91
97
98
109
110
111
114
115
116
124
125
82
88
89
100
101
102
105
106
107
115
116
92
98
99
110
111
112
115
116
117
125
126
83
89
90
101
102
103
106
107
108
116
117
93
99
100
111
112
113
116
117
118
126
127
84
90
91
102
103
104
107
108
109
117
118
113
119
120
131
132
133
136
137
138
146
147
114
120
121
132
133
134
137
138
139
147
148
65
71
72
83
84
85
88
89
90
98
99
71
77
78
89
90
91
94
95
96
104
105
72
78
79
90
91
92
95
96
97
105
106
102
108
109
120
121
122
125
126
127
135
136
92
98
99
110
111
112
115
116
117
125
126
83
89
90
101
102
103
106
107
108
116
117
93
99
100
111
112
113
116
117
118
126
127
84
90
91
102
103
104
107
108
109
117
118
94
100
101
112
113
114
117
118
119
127
128
85
91
92
103
104
105
108
109
110
118
119
114
120
121
132
133
134
137
138
139
147
148
115
121
122
133
134
135
138
139
140
148
149
66
72
73
84
85
86
89
90
91
99
100
72
78
79
90
91
92
95
96
97
105
106
73
79
80
91
92
93
96
97
98
106
107
103
109
110
121
122
123
126
127
128
136
137
93
99
100
111
112
113
116
117
118
126
127
84
90
91
102
103
104
107
108
109
117
118
94
100
101
112
113
114
117
118
119
127
128
85
91
92
103
104
105
108
109
110
118
119
95
101
102
113
114
115
118
119
120
128
129
86
92
93
104
105
106
109
110
111
119
120
115
121
122
133
134
135
138
139
140
148
149
116
122
123
134
135
136
139
140
141
149
150
71
77
78
89
90
91
94
95
96
104
105
77
83
84
95
96
97
100
101
102
110
111
78
84
85
96
97
98
101
102
103
111
112
108
114
115
126
127
128
131
132
133
141
142
98
104
105
116
117
118
121
122
123
131
132
89
95
96
107
108
109
112
113
114
122
123
99
105
106
117
118
119
122
123
124
132
133
90
96
97
108
109
110
113
114
115
123
124
100
106
107
118
119
120
123
124
125
133
134
91
97
98
109
110
111
114
115
116
124
125
120
126
127
138
139
140
143
144
145
153
154
121
127
128
139
140
141
144
145
146
154
155
72
78
79
90
91
92
95
96
97
105
106
78
84
85
96
97
98
101
102
103
111
112
79
85
86
97
98
99
102
103
104
112
113
109
115
116
127
128
129
132
133
134
142
143
99
105
106
117
118
119
122
123
124
132
133
90
96
97
108
109
110
113
114
115
123
124
100
106
107
118
119
120
123
124
125
133
134
91
97
98
109
110
111
114
115
116
124
125
101
107
108
119
120
121
124
125
126
134
135
92
98
99
110
111
112
115
116
117
125
126
121
127
128
139
140
141
144
145
146
154
155
122
128
129
140
141
142
145
146
147
155
156
73
79
80
91
92
93
96
97
98
106
107
79
85
86
97
98
99
102
103
104
112
113
80
86
87
98
99
100
103
104
105
113
114
110
116
117
128
129
130
133
134
135
143
144
100
106
107
118
119
120
123
124
125
133
134
91
97
98
109
110
111
114
115
116
124
125
101
107
108
119
120
121
124
125
126
134
135
92
98
99
110
111
112
115
116
117
125
126
102
108
109
120
121
122
125
126
127
135
136
93
99
100
111
112
113
116
117
118
126
127
122
128
129
140
141
142
145
146
147
155
156
123
129
130
141
142
143
146
147
148
156
157
90
96
97
108
109
110
113
114
115
123
124
96
102
103
114
115
116
119
120
121
129
130
97
103
104
115
116
117
120
121
122
130
131
127
133
134
145
146
147
150
151
152
160
161
117
123
124
135
136
137
140
141
142
150
151
108
114
115
126
127
128
131
132
133
141
142
118
124
125
136
137
138
141
142
143
151
152
109
115
116
127
128
129
132
133
134
142
143
119
125
126
137
138
139
142
143
144
152
153
110
116
117
128
129
130
133
134
135
143
144
139
145
146
157
158
159
162
163
164
172
173
140
146
147
158
159
160
163
164
165
173
174
91
97
98
109
110
111
114
115
116
124
125
97
103
104
115
116
117
120
121
122
130
131
98
104
105
116
117
118
121
122
123
131
132
128
134
135
146
147
148
151
152
153
161
162
118
124
125
136
137
138
141
142
143
151
152
109
115
116
127
128
129
132
133
134
142
143
119
125
126
137
138
139
142
143
144
152
153
110
116
117
128
129
130
133
134
135
143
144
120
126
127
138
139
140
143
144
145
153
154
111
117
118
129
130
131
134
135
136
144
145
140
146
147
158
159
160
163
164
165
173
174
141
147
148
159
160
161
164
165
166
174
175
Starting Impala Shell without Kerberos authentication
Connected to cp-1:21000
Server version: impalad version 2.12.0-cdh5.15.1 RELEASE (build 64f4e19bf59fab8664ebff7e80fc70570dcd8cb8)
Query: use tpcds_5000_parquet
Query: create table tpcds_5000_q25_results.store_sales_union1__store_returns__catalog_sales as select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,sum(ss_net_profit) as store_sales_profit ,sum(sr_net_loss) as store_returns_loss ,sum(cs_net_profit) as catalog_sales_profit, count(*) as groupsize from store_sales_union1 as store_sales ,store_returns as store_returns ,catalog_sales as catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy between 4 and 10 and d2.d_year = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy between 4 and 10 and d3.d_year = 2000 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name
Query submitted at: 2018-09-17 21:08:49 (Coordinator: http://cp-1.cloudera-test.rdmaresearch-pg0.wisc.cloudlab.us:25000)
Query progress can be monitored at: http://cp-1.cloudera-test.rdmaresearch-pg0.wisc.cloudlab.us:25000/query_plan?query_id=704dddb5a6e25421:a4ce2b5c00000000
Inserted 26051 row(s)
WARNINGS: Ignoring ORDER BY clause without LIMIT or OFFSET: ORDER BY i_item_id ASC, i_item_desc ASC, s_store_id ASC, s_store_name ASC.
An ORDER BY appearing in a view, subquery, union operand, or an insert/ctas statement has no effect on the query result unless a LIMIT and/or OFFSET is used in conjunction with the ORDER BY.

Fetched 1 row(s) in 112.60s
Starting Impala Shell without Kerberos authentication
Connected to cp-1:21000
Server version: impalad version 2.12.0-cdh5.15.1 RELEASE (build 64f4e19bf59fab8664ebff7e80fc70570dcd8cb8)
Query: use tpcds_5000_parquet
Query: create table tpcds_5000_q25_results.store_sales__store_returns_union1__catalog_sales as select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,sum(ss_net_profit) as store_sales_profit ,sum(sr_net_loss) as store_returns_loss ,sum(cs_net_profit) as catalog_sales_profit, count(*) as groupsize from store_sales as store_sales ,store_returns_union1 as store_returns ,catalog_sales as catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy between 4 and 10 and d2.d_year = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy between 4 and 10 and d3.d_year = 2000 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name
Query submitted at: 2018-09-17 21:10:52 (Coordinator: http://cp-1.cloudera-test.rdmaresearch-pg0.wisc.cloudlab.us:25000)
Query progress can be monitored at: http://cp-1.cloudera-test.rdmaresearch-pg0.wisc.cloudlab.us:25000/query_plan?query_id=9a41ee3eeda67e0f:312f521400000000
Inserted 20523 row(s)
WARNINGS: Ignoring ORDER BY clause without LIMIT or OFFSET: ORDER BY i_item_id ASC, i_item_desc ASC, s_store_id ASC, s_store_name ASC.
An ORDER BY appearing in a view, subquery, union operand, or an insert/ctas statement has no effect on the query result unless a LIMIT and/or OFFSET is used in conjunction with the ORDER BY.

Fetched 1 row(s) in 88.49s
Starting Impala Shell without Kerberos authentication
Connected to cp-1:21000
Server version: impalad version 2.12.0-cdh5.15.1 RELEASE (build 64f4e19bf59fab8664ebff7e80fc70570dcd8cb8)
Query: use tpcds_5000_parquet
Query: create table tpcds_5000_q25_results.store_sales__store_returns__catalog_sales_union1 as select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,sum(ss_net_profit) as store_sales_profit ,sum(sr_net_loss) as store_returns_loss ,sum(cs_net_profit) as catalog_sales_profit, count(*) as groupsize from store_sales as store_sales ,store_returns as store_returns ,catalog_sales_union1 as catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy between 4 and 10 and d2.d_year = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy between 4 and 10 and d3.d_year = 2000 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name
Query submitted at: 2018-09-17 21:12:24 (Coordinator: http://cp-1.cloudera-test.rdmaresearch-pg0.wisc.cloudlab.us:25000)
Query progress can be monitored at: http://cp-1.cloudera-test.rdmaresearch-pg0.wisc.cloudlab.us:25000/query_plan?query_id=7a49778af433fa72:4a03551300000000
Inserted 22909 row(s)
WARNINGS: Ignoring ORDER BY clause without LIMIT or OFFSET: ORDER BY i_item_id ASC, i_item_desc ASC, s_store_id ASC, s_store_name ASC.
An ORDER BY appearing in a view, subquery, union operand, or an insert/ctas statement has no effect on the query result unless a LIMIT and/or OFFSET is used in conjunction with the ORDER BY.

Fetched 1 row(s) in 91.51s
